<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Tambang Uang Online dengan Iklan</title>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

    <!-- Google AdSense -->
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9565554823368238"
      crossorigin="anonymous"
    ></script>

    <style>
      body {
        font-family: Arial, sans-serif;
        text-align: center;
        margin-top: 50px;
      }
      input,
      button {
        font-size: 16px;
        padding: 8px;
        margin: 5px;
      }
      #game {
        display: none;
      }
      .ads-container {
        margin: 20px auto;
        max-width: 320px;
      }
    </style>
  </head>
  <body>
    <h1>Tambang Uang Online dengan Iklan</h1>

    <div id="login">
      <input type="email" id="email" placeholder="Email" />
      <input type="password" id="password" placeholder="Password" />
      <br />
      <button onclick="login()">Login</button>
      <button onclick="signup()">Daftar</button>
      <div id="msg" style="color: red; margin-top: 10px"></div>
    </div>

    <div id="game">
      <h2>Halo, <span id="userEmail"></span></h2>
      <p>Poin: <span id="points">0</span></p>
      <button onclick="earnPoints()">Klik Dapat Poin</button><br />
      <button onclick="cashOut()">Cairkan Poin</button><br />
      <button onclick="logout()">Logout</button>
      <div id="cashMsg" style="margin-top: 10px; color: green"></div>

      <!-- Container Iklan -->
      <div class="ads-container">
        <ins
          class="adsbygoogle"
          style="display: block"
          data-ad-client="ca-pub-9565554823368238"
          data-ad-slot="4510048426"
          data-ad-format="auto"
          data-full-width-responsive="true"
        ></ins>
      </div>
    </div>

    <script>
      // Ganti dengan config Firebase kamu sendiri
      const firebaseConfig = {
        apiKey: "AIzaSyDFi10wt3XGJAWI8VcwRMbKEYmNtIqbWd0",
        authDomain: "website-iklan.firebaseapp.com",
        projectId: "website-iklan",
        storageBucket: "website-iklan.appspot.com",
        messagingSenderId: "530862404478",
        appId: "1:530862404478:web:b23598dccd084a501db92f",
        measurementId: "G-SWXESFEY0V",
      };

      firebase.initializeApp(firebaseConfig);

      const auth = firebase.auth();
      const db = firebase.database();

      const loginDiv = document.getElementById("login");
      const gameDiv = document.getElementById("game");
      const userEmailSpan = document.getElementById("userEmail");
      const pointsSpan = document.getElementById("points");
      const msgDiv = document.getElementById("msg");
      const cashMsgDiv = document.getElementById("cashMsg");

      let userId = null;
      let points = 0;

      auth.onAuthStateChanged((user) => {
        if (user) {
          userId = user.uid;
          userEmailSpan.textContent = user.email;
          loginDiv.style.display = "none";
          gameDiv.style.display = "block";
          loadPoints();
          // Load iklan Google AdSense (perlu dipanggil ulang setelah elemen muncul)
          (adsbygoogle = window.adsbygoogle || []).push({});
        } else {
          userId = null;
          points = 0;
          pointsSpan.textContent = points;
          loginDiv.style.display = "block";
          gameDiv.style.display = "none";
          msgDiv.textContent = "";
          cashMsgDiv.textContent = "";
        }
      });

      function login() {
        const email = document.getElementById("email").value;
        const password = document.getElementById("password").value;
        auth
          .signInWithEmailAndPassword(email, password)
          .then(() => (msgDiv.textContent = ""))
          .catch((e) => (msgDiv.textContent = "Login gagal: " + e.message));
      }

      function signup() {
        const email = document.getElementById("email").value;
        const password = document.getElementById("password").value;
        auth
          .createUserWithEmailAndPassword(email, password)
          .then(
            () => (
              (msgDiv.style.color = "green"),
              (msgDiv.textContent = "Daftar berhasil, silakan login.")
            )
          )
          .catch(
            (e) => (
              (msgDiv.style.color = "red"),
              (msgDiv.textContent = "Daftar gagal: " + e.message)
            )
          );
      }

      function logout() {
        auth.signOut();
      }

      function loadPoints() {
        db.ref("users/" + userId + "/points")
          .once("value")
          .then((snapshot) => {
            points = snapshot.val() || 0;
            pointsSpan.textContent = points;
          });
      }

      function savePoints() {
        db.ref("users/" + userId).update({ points });
      }

      function earnPoints() {
        const earned = Math.floor(Math.random() * 10) + 1;
        points += earned;
        pointsSpan.textContent = points;
        savePoints();
        cashMsgDiv.textContent = `Kamu dapat ${earned} poin!`;
      }

      function cashOut() {
        if (points >= 100) {
          const money = points * 0.1;
          points = 0;
          pointsSpan.textContent = points;
          savePoints();
          cashMsgDiv.textContent = `Berhasil cairkan Rp${money.toFixed(
            2
          )} (Simulasi)`;
        } else {
          cashMsgDiv.textContent =
            "Poin belum cukup untuk dicairkan (minimal 100 poin)";
        }
      }
    </script>
  </body>
</html>
